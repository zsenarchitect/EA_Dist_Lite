module.exports=[71815,(e,t,n)=>{t.exports=e.x("sharp",()=>require("sharp"))},530,e=>{"use strict";var t,n,a,o,i,r,s,l,c,d,u,h,p,m,g,f,y,w,E,C,T,b,O,v,S=e.i(47909),R=e.i(74017),_=e.i(96250),I=e.i(59756),A=e.i(61916),N=e.i(14444),M=e.i(37092),x=e.i(69741),P=e.i(16795),k=e.i(87718),$=e.i(95169),D=e.i(47587),H=e.i(66012),L=e.i(70101),U=e.i(26937),F=e.i(10372),G=e.i(93695);e.i(52474);var j=e.i(220),K=e.i(89171);(t=p||(p={})).STRING="string",t.NUMBER="number",t.INTEGER="integer",t.BOOLEAN="boolean",t.ARRAY="array",t.OBJECT="object",(n=m||(m={})).LANGUAGE_UNSPECIFIED="language_unspecified",n.PYTHON="python",(a=g||(g={})).OUTCOME_UNSPECIFIED="outcome_unspecified",a.OUTCOME_OK="outcome_ok",a.OUTCOME_FAILED="outcome_failed",a.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded";let q=["user","model","function","system"];(o=f||(f={})).HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",o.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",o.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",o.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",o.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",o.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",(i=y||(y={})).HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE",(r=w||(w={})).HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",r.NEGLIGIBLE="NEGLIGIBLE",r.LOW="LOW",r.MEDIUM="MEDIUM",r.HIGH="HIGH",(s=E||(E={})).BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",s.SAFETY="SAFETY",s.OTHER="OTHER",(l=C||(C={})).FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",l.STOP="STOP",l.MAX_TOKENS="MAX_TOKENS",l.SAFETY="SAFETY",l.RECITATION="RECITATION",l.LANGUAGE="LANGUAGE",l.BLOCKLIST="BLOCKLIST",l.PROHIBITED_CONTENT="PROHIBITED_CONTENT",l.SPII="SPII",l.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",l.OTHER="OTHER",(c=T||(T={})).TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",c.RETRIEVAL_QUERY="RETRIEVAL_QUERY",c.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",c.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",c.CLASSIFICATION="CLASSIFICATION",c.CLUSTERING="CLUSTERING",(d=b||(b={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",d.AUTO="AUTO",d.ANY="ANY",d.NONE="NONE",(u=O||(O={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",u.MODE_DYNAMIC="MODE_DYNAMIC";class B extends Error{constructor(e){super(`[GoogleGenerativeAI Error]: ${e}`)}}class Y extends B{constructor(e,t){super(e),this.response=t}}class W extends B{constructor(e,t,n,a){super(e),this.status=t,this.statusText=n,this.errorDetails=a}}class J extends B{}class z extends B{}(h=v||(v={})).GENERATE_CONTENT="generateContent",h.STREAM_GENERATE_CONTENT="streamGenerateContent",h.COUNT_TOKENS="countTokens",h.EMBED_CONTENT="embedContent",h.BATCH_EMBED_CONTENTS="batchEmbedContents";class V{constructor(e,t,n,a,o){this.model=e,this.task=t,this.apiKey=n,this.stream=a,this.requestOptions=o}toString(){var e,t;let n=(null==(e=this.requestOptions)?void 0:e.apiVersion)||"v1beta",a=(null==(t=this.requestOptions)?void 0:t.baseUrl)||"https://generativelanguage.googleapis.com",o=`${a}/${n}/${this.model}:${this.task}`;return this.stream&&(o+="?alt=sse"),o}}async function X(e){var t,n;let a,o=new Headers;o.append("Content-Type","application/json"),o.append("x-goog-api-client",(n=e.requestOptions,a=[],(null==n?void 0:n.apiClient)&&a.push(n.apiClient),a.push("genai-js/0.24.1"),a.join(" "))),o.append("x-goog-api-key",e.apiKey);let i=null==(t=e.requestOptions)?void 0:t.customHeaders;if(i){if(!(i instanceof Headers))try{i=new Headers(i)}catch(e){throw new J(`unable to convert customHeaders value ${JSON.stringify(i)} to Headers: ${e.message}`)}for(let[e,t]of i.entries()){if("x-goog-api-key"===e)throw new J(`Cannot set reserved header name ${e}`);if("x-goog-api-client"===e)throw new J(`Header name ${e} can only be set using the apiClient field`);o.append(e,t)}}return o}async function Q(e,t,n,a,o,i){let r=new V(e,t,n,a,i);return{url:r.toString(),fetchOptions:Object.assign(Object.assign({},function(e){let t={};if((null==e?void 0:e.signal)!==void 0||(null==e?void 0:e.timeout)>=0){let n=new AbortController;(null==e?void 0:e.timeout)>=0&&setTimeout(()=>n.abort(),e.timeout),(null==e?void 0:e.signal)&&e.signal.addEventListener("abort",()=>{n.abort()}),t.signal=n.signal}return t}(i)),{method:"POST",headers:await X(r),body:o})}}async function Z(e,t,n,a,o,i={},r=fetch){let{url:s,fetchOptions:l}=await Q(e,t,n,a,o,i);return ee(s,l,r)}async function ee(e,t,n=fetch){let a;try{a=await n(e,t)}catch(n){var o=n,i=e;let t=o;throw"AbortError"===t.name?(t=new z(`Request aborted when fetching ${i.toString()}: ${o.message}`)).stack=o.stack:o instanceof W||o instanceof J||((t=new B(`Error fetching from ${i.toString()}: ${o.message}`)).stack=o.stack),t}return a.ok||await et(a,e),a}async function et(e,t){let n,a="";try{let t=await e.json();a=t.error.message,t.error.details&&(a+=` ${JSON.stringify(t.error.details)}`,n=t.error.details)}catch(e){}throw new W(`Error fetching from ${t.toString()}: [${e.status} ${e.statusText}] ${a}`,e.status,e.statusText,n)}function en(e){return e.text=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),ei(e.candidates[0]))throw new Y(`${er(e)}`,e);return function(e){var t,n,a,o;let i=[];if(null==(n=null==(t=e.candidates)?void 0:t[0].content)?void 0:n.parts)for(let t of null==(o=null==(a=e.candidates)?void 0:a[0].content)?void 0:o.parts)t.text&&i.push(t.text),t.executableCode&&i.push("\n```"+t.executableCode.language+"\n"+t.executableCode.code+"\n```\n"),t.codeExecutionResult&&i.push("\n```\n"+t.codeExecutionResult.output+"\n```\n");return i.length>0?i.join(""):""}(e)}if(e.promptFeedback)throw new Y(`Text not available. ${er(e)}`,e);return""},e.functionCall=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),ei(e.candidates[0]))throw new Y(`${er(e)}`,e);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),ea(e)[0]}if(e.promptFeedback)throw new Y(`Function call not available. ${er(e)}`,e)},e.functionCalls=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),ei(e.candidates[0]))throw new Y(`${er(e)}`,e);return ea(e)}if(e.promptFeedback)throw new Y(`Function call not available. ${er(e)}`,e)},e}function ea(e){var t,n,a,o;let i=[];if(null==(n=null==(t=e.candidates)?void 0:t[0].content)?void 0:n.parts)for(let t of null==(o=null==(a=e.candidates)?void 0:a[0].content)?void 0:o.parts)t.functionCall&&i.push(t.functionCall);return i.length>0?i:void 0}let eo=[C.RECITATION,C.SAFETY,C.LANGUAGE];function ei(e){return!!e.finishReason&&eo.includes(e.finishReason)}function er(e){var t,n,a;let o="";if((!e.candidates||0===e.candidates.length)&&e.promptFeedback)o+="Response was blocked",(null==(t=e.promptFeedback)?void 0:t.blockReason)&&(o+=` due to ${e.promptFeedback.blockReason}`),(null==(n=e.promptFeedback)?void 0:n.blockReasonMessage)&&(o+=`: ${e.promptFeedback.blockReasonMessage}`);else if(null==(a=e.candidates)?void 0:a[0]){let t=e.candidates[0];ei(t)&&(o+=`Candidate was blocked due to ${t.finishReason}`,t.finishMessage&&(o+=`: ${t.finishMessage}`))}return o}function es(e){return this instanceof es?(this.v=e,this):new es(e)}"function"==typeof SuppressedError&&SuppressedError;let el=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;async function ec(e){let t=[],n=e.getReader();for(;;){let{done:e,value:a}=await n.read();if(e)return en(function(e){let t=e[e.length-1],n={promptFeedback:null==t?void 0:t.promptFeedback};for(let t of e){if(t.candidates){let e=0;for(let a of t.candidates)if(n.candidates||(n.candidates=[]),n.candidates[e]||(n.candidates[e]={index:e}),n.candidates[e].citationMetadata=a.citationMetadata,n.candidates[e].groundingMetadata=a.groundingMetadata,n.candidates[e].finishReason=a.finishReason,n.candidates[e].finishMessage=a.finishMessage,n.candidates[e].safetyRatings=a.safetyRatings,a.content&&a.content.parts){n.candidates[e].content||(n.candidates[e].content={role:a.content.role||"user",parts:[]});let t={};for(let o of a.content.parts)o.text&&(t.text=o.text),o.functionCall&&(t.functionCall=o.functionCall),o.executableCode&&(t.executableCode=o.executableCode),o.codeExecutionResult&&(t.codeExecutionResult=o.codeExecutionResult),0===Object.keys(t).length&&(t.text=""),n.candidates[e].content.parts.push(t)}e++}t.usageMetadata&&(n.usageMetadata=t.usageMetadata)}return n}(t));t.push(a)}}async function ed(e,t,n,a){return function(e){let t,[n,a]=(t=e.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})).getReader(),new ReadableStream({start(e){let n="";return function a(){return t.read().then(({value:t,done:o})=>{let i;if(o)return n.trim()?void e.error(new B("Failed to parse stream")):void e.close();let r=(n+=t).match(el);for(;r;){try{i=JSON.parse(r[1])}catch(t){e.error(new B(`Error parsing JSON response: "${r[1]}"`));return}e.enqueue(i),r=(n=n.substring(r[0].length)).match(el)}return a()}).catch(e=>{let t=e;throw t.stack=e.stack,t="AbortError"===t.name?new z("Request aborted when reading from the stream"):new B("Error reading from the stream")})}()}})).tee();return{stream:function(e){return function(e,t,n){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var a,o=n.apply(e,t||[]),i=[];return a={},r("next"),r("throw"),r("return"),a[Symbol.asyncIterator]=function(){return this},a;function r(e){o[e]&&(a[e]=function(t){return new Promise(function(n,a){i.push([e,t,n,a])>1||s(e,t)})})}function s(e,t){try{var n;(n=o[e](t)).value instanceof es?Promise.resolve(n.value.v).then(l,c):d(i[0][2],n)}catch(e){d(i[0][3],e)}}function l(e){s("next",e)}function c(e){s("throw",e)}function d(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}(this,arguments,function*(){let t=e.getReader();for(;;){let{value:e,done:n}=yield es(t.read());if(n)break;yield yield es(en(e))}})}(n),response:ec(a)}}(await Z(t,v.STREAM_GENERATE_CONTENT,e,!0,JSON.stringify(n),a))}async function eu(e,t,n,a){let o=await Z(t,v.GENERATE_CONTENT,e,!1,JSON.stringify(n),a);return{response:en(await o.json())}}function eh(e){if(null!=e){if("string"==typeof e)return{role:"system",parts:[{text:e}]};if(e.text)return{role:"system",parts:[e]};if(e.parts)if(!e.role)return{role:"system",parts:e.parts};else return e}}function ep(e){let t=[];if("string"==typeof e)t=[{text:e}];else for(let n of e)"string"==typeof n?t.push({text:n}):t.push(n);var n=t;let a={role:"user",parts:[]},o={role:"function",parts:[]},i=!1,r=!1;for(let e of n)"functionResponse"in e?(o.parts.push(e),r=!0):(a.parts.push(e),i=!0);if(i&&r)throw new B("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!i&&!r)throw new B("No content is provided for sending chat message.");return i?a:o}function em(e){let t;return t=e.contents?e:{contents:[ep(e)]},e.systemInstruction&&(t.systemInstruction=eh(e.systemInstruction)),t}let eg=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],ef={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function ey(e){var t;if(void 0===e.candidates||0===e.candidates.length)return!1;let n=null==(t=e.candidates[0])?void 0:t.content;if(void 0===n||void 0===n.parts||0===n.parts.length)return!1;for(let e of n.parts)if(void 0===e||0===Object.keys(e).length||void 0!==e.text&&""===e.text)return!1;return!0}let ew="SILENT_ERROR";class eE{constructor(e,t,n,a={}){this.model=t,this.params=n,this._requestOptions=a,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,(null==n?void 0:n.history)&&(!function(e){let t=!1;for(let n of e){let{role:e,parts:a}=n;if(!t&&"user"!==e)throw new B(`First content should be with role 'user', got ${e}`);if(!q.includes(e))throw new B(`Each item should include role field. Got ${e} but valid roles are: ${JSON.stringify(q)}`);if(!Array.isArray(a))throw new B("Content should have 'parts' property with an array of Parts");if(0===a.length)throw new B("Each Content should have at least one part");let o={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(let e of a)for(let t of eg)t in e&&(o[t]+=1);let i=ef[e];for(let t of eg)if(!i.includes(t)&&o[t]>0)throw new B(`Content with role '${e}' can't contain '${t}' part`);t=!0}}(n.history),this._history=n.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e,t={}){var n,a,o,i,r,s;let l;await this._sendPromise;let c=ep(e),d={safetySettings:null==(n=this.params)?void 0:n.safetySettings,generationConfig:null==(a=this.params)?void 0:a.generationConfig,tools:null==(o=this.params)?void 0:o.tools,toolConfig:null==(i=this.params)?void 0:i.toolConfig,systemInstruction:null==(r=this.params)?void 0:r.systemInstruction,cachedContent:null==(s=this.params)?void 0:s.cachedContent,contents:[...this._history,c]},u=Object.assign(Object.assign({},this._requestOptions),t);return this._sendPromise=this._sendPromise.then(()=>eu(this._apiKey,this.model,d,u)).then(e=>{var t;if(ey(e.response)){this._history.push(c);let n=Object.assign({parts:[],role:"model"},null==(t=e.response.candidates)?void 0:t[0].content);this._history.push(n)}else{let t=er(e.response);t&&console.warn(`sendMessage() was unsuccessful. ${t}. Inspect response object for details.`)}l=e}).catch(e=>{throw this._sendPromise=Promise.resolve(),e}),await this._sendPromise,l}async sendMessageStream(e,t={}){var n,a,o,i,r,s;await this._sendPromise;let l=ep(e),c={safetySettings:null==(n=this.params)?void 0:n.safetySettings,generationConfig:null==(a=this.params)?void 0:a.generationConfig,tools:null==(o=this.params)?void 0:o.tools,toolConfig:null==(i=this.params)?void 0:i.toolConfig,systemInstruction:null==(r=this.params)?void 0:r.systemInstruction,cachedContent:null==(s=this.params)?void 0:s.cachedContent,contents:[...this._history,l]},d=Object.assign(Object.assign({},this._requestOptions),t),u=ed(this._apiKey,this.model,c,d);return this._sendPromise=this._sendPromise.then(()=>u).catch(e=>{throw Error(ew)}).then(e=>e.response).then(e=>{if(ey(e)){this._history.push(l);let t=Object.assign({},e.candidates[0].content);t.role||(t.role="model"),this._history.push(t)}else{let t=er(e);t&&console.warn(`sendMessageStream() was unsuccessful. ${t}. Inspect response object for details.`)}}).catch(e=>{e.message!==ew&&console.error(e)}),u}}async function eC(e,t,n,a){return(await Z(t,v.COUNT_TOKENS,e,!1,JSON.stringify(n),a)).json()}async function eT(e,t,n,a){return(await Z(t,v.EMBED_CONTENT,e,!1,JSON.stringify(n),a)).json()}async function eb(e,t,n,a){let o=n.requests.map(e=>Object.assign(Object.assign({},e),{model:t}));return(await Z(t,v.BATCH_EMBED_CONTENTS,e,!1,JSON.stringify({requests:o}),a)).json()}class eO{constructor(e,t,n={}){this.apiKey=e,this._requestOptions=n,t.model.includes("/")?this.model=t.model:this.model=`models/${t.model}`,this.generationConfig=t.generationConfig||{},this.safetySettings=t.safetySettings||[],this.tools=t.tools,this.toolConfig=t.toolConfig,this.systemInstruction=eh(t.systemInstruction),this.cachedContent=t.cachedContent}async generateContent(e,t={}){var n;let a=em(e),o=Object.assign(Object.assign({},this._requestOptions),t);return eu(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:null==(n=this.cachedContent)?void 0:n.name},a),o)}async generateContentStream(e,t={}){var n;let a=em(e),o=Object.assign(Object.assign({},this._requestOptions),t);return ed(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:null==(n=this.cachedContent)?void 0:n.name},a),o)}startChat(e){var t;return new eE(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:null==(t=this.cachedContent)?void 0:t.name},e),this._requestOptions)}async countTokens(e,t={}){let n=function(e,t){var n;let a={model:null==t?void 0:t.model,generationConfig:null==t?void 0:t.generationConfig,safetySettings:null==t?void 0:t.safetySettings,tools:null==t?void 0:t.tools,toolConfig:null==t?void 0:t.toolConfig,systemInstruction:null==t?void 0:t.systemInstruction,cachedContent:null==(n=null==t?void 0:t.cachedContent)?void 0:n.name,contents:[]},o=null!=e.generateContentRequest;if(e.contents){if(o)throw new J("CountTokensRequest must have one of contents or generateContentRequest, not both.");a.contents=e.contents}else if(o)a=Object.assign(Object.assign({},a),e.generateContentRequest);else{let t=ep(e);a.contents=[t]}return{generateContentRequest:a}}(e,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),a=Object.assign(Object.assign({},this._requestOptions),t);return eC(this.apiKey,this.model,n,a)}async embedContent(e,t={}){let n="string"==typeof e||Array.isArray(e)?{content:ep(e)}:e,a=Object.assign(Object.assign({},this._requestOptions),t);return eT(this.apiKey,this.model,n,a)}async batchEmbedContents(e,t={}){let n=Object.assign(Object.assign({},this._requestOptions),t);return eb(this.apiKey,this.model,e,n)}}class ev{constructor(e){this.apiKey=e}getGenerativeModel(e,t){if(!e.model)throw new B("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new eO(this.apiKey,e,t)}getGenerativeModelFromCachedContent(e,t,n){if(!e.name)throw new J("Cached content must contain a `name` field.");if(!e.model)throw new J("Cached content must contain a `model` field.");for(let n of["model","systemInstruction"])if((null==t?void 0:t[n])&&e[n]&&(null==t?void 0:t[n])!==e[n]){if("model"===n&&(t.model.startsWith("models/")?t.model.replace("models/",""):t.model)===(e.model.startsWith("models/")?e.model.replace("models/",""):e.model))continue;throw new J(`Different value for "${n}" specified in modelParams (${t[n]}) and cachedContent (${e[n]})`)}let a=Object.assign(Object.assign({},t),{model:e.model,tools:e.tools,toolConfig:e.toolConfig,systemInstruction:e.systemInstruction,cachedContent:e});return new eO(this.apiKey,a,n)}}var eS=e.i(71815);let eR=[{name:"New Angle 01",prompt:"change the camera angle of the given image. Editorial architectural photograph. Daylight scene with diffuse neutral sky, soft contrast, realistic reflections on glass and metallic materials. Keep all proportions and materials identical to the reference image."},{name:"New Angle 02",prompt:"close-up editorial photograph with a 50mm lens, zoomed on façade and volumetric articulation. Warm evening light (4000 K), long shadows, natural contrast. Maintain strict consistency with materials, color, and geometry from the original image. Slight tilt-up camera framing for a dynamic architectural feel."},{name:"Model Axo White",prompt:"High-resolution totally white architectural model, axonometric view from above, on urban context white base, showing all volumetric details, window openings, terraces, circulation paths, and structural articulation. Maintain consistent details and proportions from the image reference. Uniform matte white material with soft shadows. Neutral daylight environment, seamless white background. Style of museum architectural model photography exhibitions."},{name:"Model Axo Wood",prompt:"Detailed architectural model totally made of light balsa wood, viewed from above in axonometric projection, on urban context wood base, Fine-grain wood textures showing contour lines, volumetric recesses, terraces, and façade articulation. Maintain consistent details and proportions from the image reference. Neutral studio lighting with soft white background. Shot in editorial model photography style, precise and tactile realism."},{name:"Night View",prompt:"Night-time editorial photograph, maintaining composition and camera angle as reference. Night environment, Warm interior lighting (2800 K), visible depth of field and subtle atmospheric haze. Consistent proportions, materials, and façade rhythm. Urban ambient light and reflections on glass surfaces; cinematic realism."},{name:"Sketch B&W",prompt:"Hand-drawn architectural sketch from the reference image, 2-point perspective. keeping proportions, geometry, and materials consistent. Drawn with a fine black ink pen on a white textured paper, with soft gray pencil shading. Expressive linework, architectural perspective, and clear massing. Captures the essence of the project in a spontaneous design moment."},{name:"Technical Detail",prompt:"Highly detailed architectural technical drawing of a key construction detail — façade joint, structural connection, or sunshade system. Drawn with precise linework, hatching, and material indications. Black ink on white background, 1:5 scale representation. Realistic shadows and textures, like a competition presentation board detail."},{name:"Interior 01",prompt:"Interior photography consistent with the building from the base image. Furniture layout coherent with the project's geometry. Editorial realism, camera at 1.5 m height, 35 mm lens."},{name:"Interior 02",prompt:"Alternative interior photography focusing on spatial depth and light quality. Material consistency (same palette and texture fidelity as base image). Subtle human presence, volumetric clarity, and precise architectural lighting. Editorial composition in the style of Architectural Digest or Wallpaper magazine."},{name:"Detailed Section",prompt:"Architectural section drawing through the main volume, precise structure, slabs, and circulation paths. Realistic materials and textures (concrete, glazing, vegetation). Hybrid style combining linework and shaded volumes. Editorial layout with light gray background and graphic scale. Same geometry and proportions as base image."},{name:"Watercolor",prompt:"Hand-drawn architectural sketch of the same project, fine ink lines with soft watercolor wash. Slight paper texture visible, light touches of color for shadows and glazing. Perspective view capturing essence of form and massing. Artistic representation in the style of architect sketchbooks."},{name:"Facade Details",prompt:"Perspective section of the building's façade, showing only a cropped portion with full constructive realism. Cut through structure, glazing, mullions, and cladding layers, exposing insulation, shading devices, and fixings in precise alignment. Keep all materials, colors, and proportions identical to the reference image. Depict accurate junctions between floor slabs, curtain wall, and façade panels. Soft daylight (5500 K), neutral white background, subtle ambient shadows. Presented in the style of architectural competition boards — a didactic yet photorealistic perspective detail revealing architectural logic and tectonic beauty."},{name:"Exploded Axonometric",prompt:"Exploded axonometric view of the building, showing all layers and components separated in space to reveal construction sequence and structural logic. Each element (foundation, structure, envelope, interior partitions, mechanical systems) is visually separated while maintaining precise geometric alignment. Technical drawing style with clear linework, material notation, and scale references. Neutral background with subtle shadows and depth cues. Maintain exact proportions and geometry from the reference image."},{name:"Site Plan",prompt:"Bird's eye view site plan showing the building within its urban and landscape context. Include surrounding buildings, streets, green spaces, parking, pedestrian circulation, and site boundaries. Architectural drawing style with clear topographic lines, road markings, tree symbols, and building footprints. Color-coded zones for different programmatic areas. Same building geometry and proportions as reference. Professional presentation quality suitable for planning submissions."},{name:"Conceptual Diagram",prompt:"Abstract conceptual diagram showing the design principles, spatial organization, and architectural concepts of the building. Simplified geometric representation using lines, arrows, shapes, and text annotations. Color-coded zones for program, circulation, structure, and environmental systems. Minimalist aesthetic focusing on clarity and communication. Maintains spatial relationships and proportions from the reference image while translating into diagrammatic language."},{name:"Materiality Closeup",prompt:"Extreme close-up photographic study of material junctions and surface textures from the building. Focus on the tactile quality of materials: concrete grain, glass reflections, metal patina, wood texture, or composite cladding. Depth of field highlighting specific material transitions. Macro photography style with emphasis on detail, light interaction, and material authenticity. Maintains material consistency with the reference image."},{name:"Atmospheric Dusk",prompt:"Atmospheric twilight photography of the building at dusk. Warm ambient lighting transitioning from daylight to artificial illumination. Sky gradient from orange to deep blue with subtle cloud formations. Building lights beginning to glow from within, creating depth and visual interest. Long exposure aesthetic with motion blur on moving elements. Maintains building proportions and materials from reference. Cinematic and moody atmosphere."},{name:"Construction Progress",prompt:"Construction phase visualization showing the building's structural skeleton and work-in-progress state. Exposed steel or concrete framework, construction equipment, temporary structures, and safety installations visible. Realistic construction site environment with materials, tools, and worker activity. Documentary photography style with clear architectural forms emerging from the construction process. Maintains exact geometry and proportions from the reference image."},{name:"Aerial Perspective",prompt:"Drone aerial view of the building showing its relationship to the surrounding urban or landscape context. Elevated perspective revealing roof forms, site boundaries, nearby structures, and natural features. Professional aerial photography style with excellent clarity and composition. Natural daylight conditions with appropriate shadows indicating time of day. Maintains building accuracy and proportions from the reference while providing comprehensive contextual information."},{name:"Human Scale",prompt:"Street-level view of the building with human figures to establish scale and activity. People engaged in typical urban activities (walking, standing, entering/exiting) provide sense of proportion and livability. Editorial architectural photography style with emphasis on human experience of space. Natural lighting with good depth of field. Maintains strict consistency with building geometry, materials, and proportions from the reference image."},{name:"Seasonal Winter",prompt:"Winter scene of the building with snow accumulation on surfaces, icicles, and winter landscape context. Building form emphasized against white snow background. Crisp winter light with cool color temperature and clear shadows. Realistic snow textures on roofs, ledges, and ground. Maintains all architectural details, proportions, and materials from the reference image while transforming the atmospheric context to winter conditions."},{name:"Fog Atmosphere",prompt:"Misty and foggy atmospheric rendering of the building creating dramatic mood and visual depth. Fog layers create depth separation between foreground, building, and background. Soft, diffused lighting with reduced contrast. Building forms emerge from the fog with ethereal quality. Maintains accurate building geometry and proportions from reference. Cinematic and atmospheric architectural photography style."},{name:"Golden Hour",prompt:"Golden hour photography of the building with warm, directional sunlight emphasizing volumetric qualities and material textures. Low-angle sun creates dramatic shadows and highlights architectural features. Warm color temperature (3000-4000K) bathing the building in golden light. Sky shows gradient from warm orange to soft blue. Maintains all proportions, materials, and geometry from the reference image. Emphasizes three-dimensional form and spatial depth."},{name:"Brutalist Study",prompt:"Reinterpretation of the building in brutalist concrete aesthetic with raw, unfinished concrete surfaces, bold geometric forms, and heavy massing. Raw concrete texture (béton brut) with visible formwork lines and material imperfections. Strong shadows emphasizing volumetric power. Minimalist detailing with emphasis on structure and material honesty. Maintains exact proportions and geometry from the reference while transforming material expression to brutalist language."},{name:"Raining Night",prompt:"Night-time editorial photograph in heavy rain, maintaining composition and camera angle as reference. Raindrops visible on surfaces, wet reflective surfaces, puddles on ground, streaks of water on glass. Warm interior lighting (2800 K) visible through windows, creating cozy contrast with the wet exterior. Consistent proportions, materials, and façade rhythm. Urban ambient light reflecting off wet surfaces with atmospheric mist and cinematic realism. Dramatic mood enhanced by rain and darkness."}],e_=["gemini-2.5-flash-image","gemini-2.5-flash"];function eI(e,t=400,n={}){return K.NextResponse.json({ok:!1,error:e,...n},{status:t})}async function eA(){try{if(!Array.isArray(eR))return eI("PROMPTS não é um array válido",500);return K.NextResponse.json({ok:!0,prompts:eR})}catch(e){return eI(e?.message||"Erro interno ao carregar prompts",500)}}function eN(e){let t=String(e?.message||e||"").toLowerCase();return t.includes("429")||t.includes("too many requests")||t.includes("quota")||t.includes("rate limit")||e?.code===429||e?.status===429}async function eM(e,t,n,{temperature:a,seed:o,modalities:i},r=3,s){let l=null;for(let c=0;c<=r;c++)try{let r={temperature:a,responseModalities:i};return"number"==typeof o&&Number.isFinite(o)&&(r.seed=o),await e.generateContent({contents:[{role:"user",parts:[{text:t},...n]}],generationConfig:r})}catch(e){if(l=e,eN(e)&&c<r){let t=function(e){let t=e.match(/retry in ([\d.]+)s/i);if(t){let e=parseFloat(t[1]);if(!isNaN(e))return Math.ceil(1e3*e)}try{let t=e.match(/retryDelay["']:\s*["'](\d+)s["']/i);if(t)return 1e3*parseInt(t[1],10)}catch{}return null}(String(e?.message||e||""))||(c+1)*3e4;console.warn(`[POST /api/nano] Rate limit hit${s?` for ${s}`:""}, attempt ${c+1}/${r+1}. Retrying in ${(t/1e3).toFixed(1)}s...`),await new Promise(e=>setTimeout(e,t));continue}throw e}throw l}async function ex(e){try{let t=process.env.GEMINI_API_KEY;if(!t)return console.error("[POST /api/nano] Missing GEMINI_API_KEY"),eI("Missing GEMINI_API_KEY",500);let n=new URL(e.url),a=Math.max(0,Math.min(2,parseFloat(n.searchParams.get("temp")||"1"))),o=(n.searchParams.get("seedMode")||"perPrompt").toLowerCase(),i=n.searchParams.get("seed"),r=Number.isFinite(Number(i))?parseInt(i,10):Math.floor(0x7fffffff*Math.random()),s=Math.max(1,Math.min(100,parseInt(n.searchParams.get("jpeg")||"85",10))),l=n.searchParams.get("model")?.trim(),c="true"===(n.searchParams.get("includePrompt")||"false").toLowerCase(),d=Math.max(1,Math.min(4,parseInt(n.searchParams.get("countFactor")||"1",10))),u=l?[l]:e_,h="true"===n.searchParams.get("stream");console.log(`[POST /api/nano] Starting generation - temp: ${a}, seedMode: ${o}, baseSeed: ${r}, countFactor: ${d}x, models: ${u.join(", ")}`);let p=await e.formData(),m=[],g=p.get("names");if("string"==typeof g&&g.trim())try{m=JSON.parse(g)}catch{return eI("Campo 'names' inválido (esperado JSON array de strings).",400)}let f=[],y=p.get("customPrompts");if("string"==typeof y&&y.trim())try{f=JSON.parse(y)}catch{return eI("Campo 'customPrompts' inválido (esperado JSON array de PromptItem).",400)}let w=[...eR,...f],E=m.length>0?w.filter(e=>m.includes(e.name)):w;if(!E.length)return eI("Nenhum prompt selecionado/encontrado.",400);console.log(`[POST /api/nano] Processing ${E.length} prompts`);let C=p.getAll("images").filter(e=>e instanceof File);if(!C.length)return eI("Please upload at least one image.");console.log(`[POST /api/nano] Processing ${C.length} images`);let T=await Promise.all(C.map(async e=>{let t=Buffer.from(await e.arrayBuffer());return{inlineData:{data:(await (0,eS.default)(t).jpeg({quality:s}).toBuffer()).toString("base64"),mimeType:"image/jpeg"}}})),b=(e,t)=>{let n=`data: ${JSON.stringify(t)}

`;e.enqueue(new TextEncoder().encode(n))};if(h){let e=new ReadableStream({async start(e){try{let n=new ev(t),i=null,s="",l=0,h=0,p=0,m=E.length*d,g=0;for(let t of u)try{console.log(`[POST /api/nano] Trying model: ${t}`);let i=n.getGenerativeModel({model:t});s=t;let u="one"===o?r:void 0;for(let t=0;t<E.length;t++){let{name:n,prompt:r}=E[t];for(let t=0;t<d;t++){let s="one"===o?u:Math.floor(0x7fffffff*Math.random()),f=d>1?`_v${t+1}`:"",y=`${n}${f}`;g++,b(e,{type:"progress",current:g,total:m,prompt:y});let w=[{temperature:a,seed:s,modalities:["TEXT","IMAGE"]},{temperature:a,seed:s,modalities:["IMAGE"]},{temperature:a,seed:null,modalities:["TEXT","IMAGE"]}],E=null,C="image/png",O=null;for(let e=0;e<w.length;e++){let t=w[e];try{let e=await eM(i,r,T,t,3,n),a=e.response?.promptFeedback;if(a?.blockReason){O=Error(`blocked: ${a.blockReason}`);continue}if(E=(e.response?.candidates?.[0]?.content?.parts??[]).find(e=>e?.inlineData?.data)){C=E.inlineData.mimeType||"image/png";let t=e.response?.usageMetadata;t&&(l+=t.promptTokenCount||0,h+=t.candidatesTokenCount||0,p+=t.totalTokenCount||0);break}O=Error("no image in parts")}catch(e){O=e,eN(e)}await new Promise(e=>setTimeout(e,120))}let v=(C.split("/")[1]||"png").toLowerCase();if(E){let t={name:y,b64:E.inlineData.data,mime:C,seed:s,filename:`${y}.${v}`,...c?{prompt:r}:{}};b(e,{type:"image",result:t})}else b(e,{type:"error",name:y,error:O?String(O?.message||O):"no image"});await new Promise(e=>setTimeout(e,150))}}b(e,{type:"done",modelUsed:s,temp:a,seedMode:o,baseSeed:r,countFactor:d,tokenUsage:{promptTokens:l,candidatesTokens:h,totalTokens:p}}),e.close();return}catch(e){i=e,console.error(`[POST /api/nano] Model ${t} threw exception:`,e?.message||String(e))}b(e,{type:"error",error:"No model generated an image",detail:i?.message||String(i)}),e.close()}catch(t){b(e,{type:"error",error:t?.message||"Internal error"}),e.close()}}});return new Response(e,{headers:{"Content-Type":"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive"}})}let O=new ev(t),v=null;for(let e of u)try{console.log(`[POST /api/nano] Trying model: ${e}`);let t=O.getGenerativeModel({model:e}),n=[],i=0,s=0,l=0,u="one"===o?r:void 0;for(let e=0;e<E.length;e++){let{name:r,prompt:h}=E[e];for(let p=0;p<d;p++){let m="one"===o?u:Math.floor(0x7fffffff*Math.random()),g=d>1?`_v${p+1}`:"",f=`${r}${g}`;console.log(`[POST /api/nano] Processing prompt ${e+1}/${E.length}: ${f} (variation ${p+1}/${d})`);let y=[{temperature:a,seed:m,modalities:["TEXT","IMAGE"]},{temperature:a,seed:m,modalities:["IMAGE"]},{temperature:a,seed:null,modalities:["TEXT","IMAGE"]}],w=null,C="image/png",b=null;for(let e=0;e<y.length;e++){let n=y[e];try{console.log(`[POST /api/nano] Attempt ${e+1}/${y.length} for ${r} - modalities: ${n.modalities.join(", ")}, seed: ${n.seed||"null"}`);let a=await eM(t,h,T,n,3,r),o=a.response?.promptFeedback;if(o?.blockReason){b=Error(`blocked: ${o.blockReason}`),console.error(`[POST /api/nano] Prompt blocked for ${r}: ${o.blockReason}`);continue}if(w=(a.response?.candidates?.[0]?.content?.parts??[]).find(e=>e?.inlineData?.data)){C=w.inlineData.mimeType||"image/png";let t=a.response?.usageMetadata;if(t){let n=t.promptTokenCount||0,a=t.candidatesTokenCount||0,o=t.totalTokenCount||0;i+=n,s+=a,l+=o,console.log(`[POST /api/nano] Token usage for ${r} (plan ${e+1}): prompt=${n}, candidates=${a}, total=${o}`)}console.log(`[POST /api/nano] Success for ${r} with plan ${e+1}`);break}b=Error("no image in parts"),console.warn(`[POST /api/nano] No image in response parts for ${r}, plan ${e+1}`)}catch(t){b=t,console.error(`[POST /api/nano] Error for ${r}, plan ${e+1}:`,t?.message||String(t),t?.code||""),eN(t)}await new Promise(e=>setTimeout(e,120))}let O=(C.split("/")[1]||"png").toLowerCase();w?n.push({name:f,b64:w.inlineData.data,mime:C,seed:m,filename:`${f}_seed_${m}.${O}`,...c?{prompt:h}:{}}):n.push({name:f,b64:null,mime:C,seed:m,filename:`${f}_seed_${m}.${O}`,...c?{prompt:h}:{},error:b?String(b?.message||b):"no image"}),await new Promise(e=>setTimeout(e,150))}}if(n.some(e=>!!e.b64))return console.log(`[POST /api/nano] Success with model ${e} - ${n.filter(e=>e.b64).length}/${n.length} images generated`),console.log("[POST /api/nano] ===== TOTAL TOKEN USAGE ====="),console.log(`[POST /api/nano] Prompt tokens: ${i}`),console.log(`[POST /api/nano] Candidates tokens: ${s}`),console.log(`[POST /api/nano] Total tokens: ${l}`),console.log("[POST /api/nano] ============================="),K.NextResponse.json({ok:!0,modelUsed:e,temp:a,seedMode:o,baseSeed:r,countFactor:d,results:n,tokenUsage:{promptTokens:i,candidatesTokens:s,totalTokens:l}});let h=n.map(e=>({name:e.name,error:e.error})).filter(e=>e.error);return console.error(`[POST /api/nano] Model ${e} failed - no images generated. Errors:`,JSON.stringify(h,null,2)),console.log("[POST /api/nano] ===== TOTAL TOKEN USAGE ====="),console.log(`[POST /api/nano] Prompt tokens: ${i}`),console.log(`[POST /api/nano] Candidates tokens: ${s}`),console.log(`[POST /api/nano] Total tokens: ${l}`),console.log("[POST /api/nano] ============================="),K.NextResponse.json({ok:!1,error:"Model returned no images",modelUsed:e,temp:a,seedMode:o,baseSeed:r,countFactor:d,results:n,errorDetails:h,tokenUsage:{promptTokens:i,candidatesTokens:s,totalTokens:l}},{status:502})}catch(t){v=t,console.error(`[POST /api/nano] Model ${e} threw exception:`,t?.message||String(t),t?.stack||"")}return console.error("[POST /api/nano] All models failed. Last error:",v?.message||String(v)),eI("No model generated an image",500,{detail:v?.message||String(v),tried:u,errorCode:v?.code,errorStack:void 0})}catch(e){return console.error("[POST /api/nano] Unhandled exception:",e?.message||String(e),e?.stack||""),eI(e?.message||"Internal error",500,{stack:void 0,name:e?.name,code:e?.code})}}e.s(["GET",()=>eA,"POST",()=>ex,"maxDuration",0,60,"runtime",0,"nodejs"],46749);var eP=e.i(46749);let ek=new S.AppRouteRouteModule({definition:{kind:R.RouteKind.APP_ROUTE,page:"/api/nano/route",pathname:"/api/nano",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/nano/route.ts",nextConfigOutput:"standalone",userland:eP}),{workAsyncStorage:e$,workUnitAsyncStorage:eD,serverHooks:eH}=ek;function eL(){return(0,_.patchFetch)({workAsyncStorage:e$,workUnitAsyncStorage:eD})}async function eU(e,t,n){ek.isDev&&(0,I.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let a="/api/nano/route";a=a.replace(/\/index$/,"")||"/";let o=await ek.prepare(e,t,{srcPage:a,multiZoneDraftMode:!1});if(!o)return t.statusCode=400,t.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve()),null;let{buildId:i,params:r,nextConfig:s,parsedUrl:l,isDraftMode:c,prerenderManifest:d,routerServerContext:u,isOnDemandRevalidate:h,revalidateOnlyGenerated:p,resolvedPathname:m,clientReferenceManifest:g,serverActionsManifest:f}=o,y=(0,x.normalizeAppPath)(a),w=!!(d.dynamicRoutes[y]||d.routes[m]),E=async()=>((null==u?void 0:u.render404)?await u.render404(e,t,l,!1):t.end("This page could not be found"),null);if(w&&!c){let e=!!d.routes[m],t=d.dynamicRoutes[y];if(t&&!1===t.fallback&&!e){if(s.experimental.adapterPath)return await E();throw new G.NoFallbackError}}let C=null;!w||ek.isDev||c||(C="/index"===(C=m)?"/":C);let T=!0===ek.isDev||!w,b=w&&!T;f&&g&&(0,N.setReferenceManifestsSingleton)({page:a,clientReferenceManifest:g,serverActionsManifest:f,serverModuleMap:(0,M.createServerModuleMap)({serverActionsManifest:f})});let O=e.method||"GET",v=(0,A.getTracer)(),S=v.getActiveScopeSpan(),_={params:r,prerenderManifest:d,renderOpts:{experimental:{authInterrupts:!!s.experimental.authInterrupts},cacheComponents:!!s.cacheComponents,supportsDynamicResponse:T,incrementalCache:(0,I.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:s.cacheLife,waitUntil:n.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,n,a)=>ek.onRequestError(e,t,a,u)},sharedContext:{buildId:i}},K=new P.NodeNextRequest(e),q=new P.NodeNextResponse(t),B=k.NextRequestAdapter.fromNodeNextRequest(K,(0,k.signalFromNodeResponse)(t));try{let o=async e=>ek.handle(B,_).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let n=v.getRootSpanAttributes();if(!n)return;if(n.get("next.span_type")!==$.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${n.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let o=n.get("next.route");if(o){let t=`${O} ${o}`;e.setAttributes({"next.route":o,"http.route":o,"next.span_name":t}),e.updateName(t)}else e.updateName(`${O} ${a}`)}),i=!!(0,I.getRequestMeta)(e,"minimalMode"),r=async r=>{var l,m;let g=async({previousCacheEntry:s})=>{try{if(!i&&h&&p&&!s)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let a=await o(r);e.fetchMetrics=_.renderOpts.fetchMetrics;let l=_.renderOpts.pendingWaitUntil;l&&n.waitUntil&&(n.waitUntil(l),l=void 0);let c=_.renderOpts.collectedTags;if(!w)return await (0,H.sendResponse)(K,q,a,_.renderOpts.pendingWaitUntil),null;{let e=await a.blob(),t=(0,L.toNodeOutgoingHttpHeaders)(a.headers);c&&(t[F.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let n=void 0!==_.renderOpts.collectedRevalidate&&!(_.renderOpts.collectedRevalidate>=F.INFINITE_CACHE)&&_.renderOpts.collectedRevalidate,o=void 0===_.renderOpts.collectedExpire||_.renderOpts.collectedExpire>=F.INFINITE_CACHE?void 0:_.renderOpts.collectedExpire;return{value:{kind:j.CachedRouteKind.APP_ROUTE,status:a.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:n,expire:o}}}}catch(t){throw(null==s?void 0:s.isStale)&&await ek.onRequestError(e,t,{routerKind:"App Router",routePath:a,routeType:"route",revalidateReason:(0,D.getRevalidateReason)({isStaticGeneration:b,isOnDemandRevalidate:h})},u),t}},f=await ek.handleResponse({req:e,nextConfig:s,cacheKey:C,routeKind:R.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:d,isRoutePPREnabled:!1,isOnDemandRevalidate:h,revalidateOnlyGenerated:p,responseGenerator:g,waitUntil:n.waitUntil,isMinimalMode:i});if(!w)return null;if((null==f||null==(l=f.value)?void 0:l.kind)!==j.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==f||null==(m=f.value)?void 0:m.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});i||t.setHeader("x-nextjs-cache",h?"REVALIDATED":f.isMiss?"MISS":f.isStale?"STALE":"HIT"),c&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let y=(0,L.fromNodeOutgoingHttpHeaders)(f.value.headers);return i&&w||y.delete(F.NEXT_CACHE_TAGS_HEADER),!f.cacheControl||t.getHeader("Cache-Control")||y.get("Cache-Control")||y.set("Cache-Control",(0,U.getCacheControlHeader)(f.cacheControl)),await (0,H.sendResponse)(K,q,new Response(f.value.body,{headers:y,status:f.value.status||200})),null};S?await r(S):await v.withPropagatedContext(e.headers,()=>v.trace($.BaseServerSpan.handleRequest,{spanName:`${O} ${a}`,kind:A.SpanKind.SERVER,attributes:{"http.method":O,"http.target":e.url}},r))}catch(t){if(t instanceof G.NoFallbackError||await ek.onRequestError(e,t,{routerKind:"App Router",routePath:y,routeType:"route",revalidateReason:(0,D.getRevalidateReason)({isStaticGeneration:b,isOnDemandRevalidate:h})}),w)throw t;return await (0,H.sendResponse)(K,q,new Response(null,{status:500})),null}}e.s(["handler",()=>eU,"patchFetch",()=>eL,"routeModule",()=>ek,"serverHooks",()=>eH,"workAsyncStorage",()=>e$,"workUnitAsyncStorage",()=>eD],530)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__ddf8d162._.js.map