<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InDesign Writer Helper - Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f7fa;
            color: #333;
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 24px;
            font-weight: 600;
        }

        .header-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .document-info {
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
        }

        .demo-banner {
            background: #ffc107;
            color: #856404;
            padding: 10px 20px;
            text-align: center;
            font-size: 14px;
            border-bottom: 1px solid #ffeaa7;
        }

        .main-container {
            display: flex;
            height: calc(100vh - 120px);
        }

        .sidebar {
            width: 300px;
            background: white;
            border-right: 1px solid #e1e5e9;
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid #e1e5e9;
            background: #f8f9fa;
        }

        .sidebar-header h3 {
            color: #333;
            margin-bottom: 10px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .stat-item {
            background: white;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e1e5e9;
        }

        .stat-value {
            font-size: 18px;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }

        .navigation-panel {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .nav-section {
            margin-bottom: 25px;
        }

        .nav-section h4 {
            color: #333;
            margin-bottom: 15px;
            font-size: 16px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 5px;
        }

        .frame-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #e1e5e9;
            border-radius: 8px;
        }

        .frame-item {
            padding: 12px;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .frame-item:hover {
            background: #f8f9fa;
        }

        .frame-item.active {
            background: #667eea;
            color: white;
        }

        .frame-item:last-child {
            border-bottom: none;
        }

        .frame-name {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .frame-details {
            font-size: 12px;
            color: #666;
        }

        .frame-item.active .frame-details {
            color: rgba(255, 255, 255, 0.8);
        }

        .page-selector {
            margin-bottom: 15px;
        }

        .page-select {
            width: 100%;
            padding: 10px;
            border: 1px solid #e1e5e9;
            border-radius: 8px;
            background: white;
            font-size: 14px;
        }

        .search-box {
            margin-bottom: 15px;
        }

        .search-input {
            width: 100%;
            padding: 10px;
            border: 1px solid #e1e5e9;
            border-radius: 8px;
            font-size: 14px;
        }

        .content-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: white;
        }

        .toolbar {
            padding: 15px 20px;
            border-bottom: 1px solid #e1e5e9;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s;
        }

        .btn:hover {
            background: #5a6fd8;
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .frame-counter {
            background: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            color: #666;
            border: 1px solid #e1e5e9;
        }

        .text-area {
            flex: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        .text-header {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e1e5e9;
        }

        .text-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .text-meta {
            display: flex;
            gap: 20px;
            font-size: 14px;
            color: #666;
        }

        .text-content {
            flex: 1;
            border: 1px solid #e1e5e9;
            border-radius: 8px;
            padding: 20px;
            font-size: 16px;
            line-height: 1.6;
            background: #fafbfc;
            resize: none;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .text-content:focus {
            outline: none;
            border-color: #667eea;
            background: white;
        }

        .no-content {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .no-content h3 {
            margin-bottom: 10px;
            color: #333;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>InDesign Writer Helper</h1>
        <div class="header-info">
            <div class="document-info" id="documentInfo">
                Demo Mode - Sample Document
            </div>
        </div>
    </div>

    <div class="demo-banner">
        üéØ <strong>Demo Mode</strong> - This is a preview of the interface. Connect to InDesign to use the full functionality.
    </div>

    <div class="main-container">
        <div class="sidebar">
            <div class="sidebar-header">
                <h3>Document Statistics</h3>
                <div class="stats-grid" id="statsGrid">
                    <div class="stat-item">
                        <div class="stat-value" id="totalFrames">5</div>
                        <div class="stat-label">Text Frames</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="totalPages">3</div>
                        <div class="stat-label">Pages</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="totalWords">1,247</div>
                        <div class="stat-label">Words</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="totalChars">7,892</div>
                        <div class="stat-label">Characters</div>
                    </div>
                </div>
            </div>

            <div class="navigation-panel">
                <div class="nav-section">
                    <h4>Page Navigation</h4>
                    <div class="page-selector">
                        <select class="page-select" id="pageSelect" onchange="filterByPage()">
                            <option value="">All Pages</option>
                            <option value="Page 1">Page 1</option>
                            <option value="Page 2">Page 2</option>
                            <option value="Page 3">Page 3</option>
                        </select>
                    </div>
                </div>

                <div class="nav-section">
                    <h4>Search Text</h4>
                    <div class="search-box">
                        <input type="text" class="search-input" id="searchInput" placeholder="Search text content..." oninput="searchText()">
                    </div>
                </div>

                <div class="nav-section">
                    <h4>Text Frames</h4>
                    <div class="frame-list" id="frameList">
                        <!-- Demo frames will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <div class="content-area">
            <div class="toolbar">
                <button class="btn" onclick="previousFrame()" id="prevBtn">‚Üê Previous</button>
                <button class="btn" onclick="nextFrame()" id="nextBtn">Next ‚Üí</button>
                <div class="frame-counter" id="frameCounter">
                    Frame 1 of 5
                </div>
                <button class="btn btn-secondary" onclick="refreshFrames()">Refresh</button>
                <button class="btn btn-secondary" onclick="saveChanges()" id="saveBtn" disabled>Save Changes</button>
            </div>

            <div class="text-area">
                <div class="text-header" id="textHeader">
                    <div class="text-title">Main Heading Frame</div>
                    <div class="text-meta">
                        <span>Page: Page 1</span>
                        <span>Words: 3</span>
                        <span>Characters: 15</span>
                    </div>
                </div>
                <textarea class="text-content" id="textContent" placeholder="No text content available..." oninput="markAsModified()">Welcome to InDesign Writer Helper</textarea>
            </div>
        </div>
    </div>

    <script>
        // Demo data
        const demoFrames = [
            {
                index: 0,
                name: "Main Heading Frame",
                page_name: "Page 1",
                text_content: "Welcome to InDesign Writer Helper",
                word_count: 3,
                character_count: 15
            },
            {
                index: 1,
                name: "Introduction Text",
                page_name: "Page 1",
                text_content: "This is a powerful tool for managing text content in your InDesign documents. You can view, edit, and navigate through all text frames with ease.",
                word_count: 25,
                character_count: 156
            },
            {
                index: 2,
                name: "Feature List",
                page_name: "Page 2",
                text_content: "‚Ä¢ Auto-detect InDesign and open documents\n‚Ä¢ View all text frames in your document\n‚Ä¢ Navigate between text frames and pages\n‚Ä¢ Preview text content in a large text box\n‚Ä¢ Search and filter text content\n‚Ä¢ Future: AI-powered text suggestions",
                word_count: 45,
                character_count: 298
            },
            {
                index: 3,
                name: "Technical Details",
                page_name: "Page 2",
                text_content: "The application uses COM automation to connect to InDesign and extract text frame information. It provides a modern web interface for easy text management and editing.",
                word_count: 28,
                character_count: 189
            },
            {
                index: 4,
                name: "Future Plans",
                page_name: "Page 3",
                text_content: "In future versions, we plan to integrate OpenAI for intelligent text suggestions, add batch operations for multiple frames, and provide advanced search capabilities with regex support.",
                word_count: 32,
                character_count: 234
            }
        ];

        let currentFrame = demoFrames[0];
        let allFrames = [...demoFrames];
        let filteredFrames = [...demoFrames];
        let currentFrameIndex = 0;
        let isModified = false;

        // Initialize on page load
        window.onload = function() {
            updateFrameList();
            updateFrameDisplay();
        };

        function updateFrameList() {
            const frameList = document.getElementById('frameList');
            
            frameList.innerHTML = filteredFrames.map((frame, index) => `
                <div class="frame-item ${index === currentFrameIndex ? 'active' : ''}" onclick="selectFrame(${index})">
                    <div class="frame-name">${frame.name}</div>
                    <div class="frame-details">
                        Page: ${frame.page_name} | Words: ${frame.word_count} | Chars: ${frame.character_count}
                    </div>
                </div>
            `).join('');
        }

        function selectFrame(index) {
            if (index >= 0 && index < filteredFrames.length) {
                currentFrameIndex = index;
                currentFrame = filteredFrames[index];
                updateFrameDisplay();
                updateFrameList();
            }
        }

        function updateFrameDisplay() {
            if (!currentFrame) {
                document.getElementById('textHeader').innerHTML = `
                    <div class="text-title">No text frame selected</div>
                    <div class="text-meta">
                        <span>Page: -</span>
                        <span>Words: 0</span>
                        <span>Characters: 0</span>
                    </div>
                `;
                document.getElementById('textContent').value = '';
                document.getElementById('frameCounter').textContent = 'Frame 0 of 0';
                return;
            }

            document.getElementById('textHeader').innerHTML = `
                <div class="text-title">${currentFrame.name}</div>
                <div class="text-meta">
                    <span>Page: ${currentFrame.page_name}</span>
                    <span>Words: ${currentFrame.word_count}</span>
                    <span>Characters: ${currentFrame.character_count}</span>
                </div>
            `;
            
            document.getElementById('textContent').value = currentFrame.text_content;
            document.getElementById('frameCounter').textContent = `Frame ${currentFrameIndex + 1} of ${filteredFrames.length}`;
            
            // Update navigation buttons
            document.getElementById('prevBtn').disabled = currentFrameIndex === 0;
            document.getElementById('nextBtn').disabled = currentFrameIndex === filteredFrames.length - 1;
            
            isModified = false;
            updateSaveButton();
        }

        function filterByPage() {
            const selectedPage = document.getElementById('pageSelect').value;
            
            if (selectedPage === '') {
                filteredFrames = [...allFrames];
            } else {
                filteredFrames = allFrames.filter(frame => frame.page_name === selectedPage);
            }
            
            currentFrameIndex = 0;
            updateFrameList();
            
            if (filteredFrames.length > 0) {
                selectFrame(0);
            } else {
                updateFrameDisplay();
            }
        }

        function searchText() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            
            if (searchTerm === '') {
                filteredFrames = [...allFrames];
            } else {
                filteredFrames = allFrames.filter(frame => 
                    frame.text_content.toLowerCase().includes(searchTerm)
                );
            }
            
            currentFrameIndex = 0;
            updateFrameList();
            
            if (filteredFrames.length > 0) {
                selectFrame(0);
            } else {
                updateFrameDisplay();
            }
        }

        function nextFrame() {
            if (currentFrameIndex < filteredFrames.length - 1) {
                selectFrame(currentFrameIndex + 1);
            }
        }

        function previousFrame() {
            if (currentFrameIndex > 0) {
                selectFrame(currentFrameIndex - 1);
            }
        }

        function markAsModified() {
            isModified = true;
            updateSaveButton();
        }

        function updateSaveButton() {
            document.getElementById('saveBtn').disabled = !isModified;
        }

        function saveChanges() {
            if (isModified && currentFrame) {
                const newContent = document.getElementById('textContent').value;
                currentFrame.text_content = newContent;
                currentFrame.character_count = newContent.length;
                currentFrame.word_count = newContent.split(/\s+/).filter(word => word.length > 0).length;
                
                isModified = false;
                updateSaveButton();
                updateFrameDisplay();
                updateFrameList();
                
                alert('Changes saved! (Demo mode - changes are not persistent)');
            }
        }

        function refreshFrames() {
            alert('Refresh functionality would reload text frames from InDesign');
        }
    </script>
</body>
</html>
